<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Buy License</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    select, input, button { padding: 8px; margin: 5px; }
    #result { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>
  <h2>Buy a License</h2>
  <img src="data:image/png;base64,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" alt="QR" />
  <label for="licenseType">Choose License Type:</label>
  <select id="licenseType">
    <option value="trial">Trial</option>
    <option value="standard">Standard</option>
    <option value="premium">Premium</option>
    <option value="enterprise">Enterprise</option>
  </select>
  
  <br/>
  
  <label for="userId">User ID:</label>
  <input type="text" id="userId" placeholder="Enter your user ID"/>
  
  <br/>
  
  <button onclick="buyLicense()">Buy License</button>
  
  <div id="result"></div>
  
  <script>
    async function buyLicense() {
      const type = document.getElementById("licenseType").value;
      const userId = document.getElementById("userId").value;
      const resultDiv = document.getElementById("result");

      try {
        const res = await fetch("http://localhost:3001/license/buy", {
          method: "POST",
          headers: { "Content-Type": "application/json","Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImJlNzhiMjAzLWNkZDgtNDhlNS1iNWJmLTY5NWUyYTE3YWMzOSIsImVtYWlsIjoid29yay5ydXBhbTQ3QGdtYWlsLmNvbSIsIm5hbWUiOiJMUFUgVW5pdmVyc2l0eSBBZG1pbiIsInJvbGUiOiJhZG1pbiIsImlhdCI6MTc1NzQ5MTUyNCwiZXhwIjoxNzU5MjE5NTI0fQ.3SscpMLkvIjfINvQg27KEaeOwXa05GWm8Zkct2-jZWY" },
          body: JSON.stringify({ type, institutionId:userId }),
        });

        const result = await res.json();
        const data = result.data;
        console.log(data);
        if (res.ok) {
          resultDiv.innerHTML = `
            ✅ License request created.<br/>
            License ID: ${data.licenseId}<br/>
            Order ID: ${data.orderId}<br/>
            State: ${data.state}<br/>
            <a href="${data.redirectUrl}" target="_blank">➡️ Pay Now</a>
          `;
        } else {
          resultDiv.innerHTML = `❌ Error: ${data.error}`;
        }
      } catch (err) {
        resultDiv.innerHTML = `❌ Request failed: ${err.message}`;
      }
    }
  </script>
</body>
</html>
